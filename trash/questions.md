# Комментарии к ТЗ Оборудование

## Ошибки/неточности/недостаток данных

### Неверная кардинальность связи с ТС.
- В поле «Установлено на ТС» указано ОдинКодному, что эквивалентно 1–1. На практике к одному ТС может быть установлено несколько единиц оборудования (трекер, датчики, антенны и т.п.). Требуется МногиеКодному (много оборудования → одно ТС). Сейчас это противоречит реальной модели использования. \
**Что делаем?**

### Неправильные названия разделов.
- В документе встречаются заголовки «Список продуктов» и «Карточка отдельного продукта», хотя речь идёт об оборудовании. \
**Переименуем в «Список оборудования», «Карточка оборудования»?**

### Создание записи только из «Накладной покупки» противоречит цели раздела.
- В начале сказано: храним оборудование «приобретённое, полученное на ответственное хранение или изготовленное». Но создание «Не предусмотрено (… только при заведении “Накладная покупки”)». 
**Нужны сценарии поступления на ответхранение, возвратов, перемещений между складами/лицами**

### Несогласованность статусов с модулем «Продукты».
- В «Оборудовании» статусы: «На складе, Выдано под отчет, Установлено, Продано, Рекламация, Утиль, У заказчика». В «Продуктах» агрегаты считают «Под отчет клиенту», «Под отчет сотруднику», «Продано», «На складе», «Рекламация», «Утиль», «Выполнено (смонтировано)». Часть статусов/категорий расходится по наименованию и смыслу (например, «У заказчика» vs «Под отчёт клиенту»; «Выполнено» vs «Установлено»). Это сломает отчёты, таблицы, фильтры и сводные показатели. \
**Нужно привести к одному виду**

### Поле «Наименование» как строка вместо связи с продуктом.
- Сейчас «Наименование» — строка «Наименование продукции, к которой относится». Это должна быть строгая ссылка МногиеКодному на сущность «Продукт», иначе потеряна нормализация и невозможна корректная аналитика/ценообразование. \
**Решить, что это будет в итоге - строка или значение из связанной записи**

### Поле «Склад» задано как строка.
- Указан «Склад(справочник)», но тип — строка. Нужна ссылка на сущность «Склад» (МногиеКодному), плюс проверка «обязательное при статусе На складе/Рекламация и т.п.; запрещено при Установлено/Утиль/У заказчика». \
**Сейчас правило описано текстом, но не формализовано. Нормализовать**

### Дублирование и неоднозначности по «под отчёт».
- Есть поле «Выдано под отчет» (ссылка на физлицо) и поле-ссылка «Выдача под отчёт» (документ).
**Нужно чётко разделить «кому выдано» (ссылка на сотрудника) и «на основании чего» (ссылка на документ). Также согласовать это с агрегатами в «Продуктах» (под отчёт сотруднику/клиенту).**

### СКЗИ поля без условий применимости и повторной установки.
- «СКЗИ дата с/по» должны появляться только для определённых типов продуктов и пересчитываться при переустановке. Сейчас этого нет; сказано лишь «3 года от даты установки».
**Нужны правила переустановки и продления.**

### «Предыдущее состояние» как поле хранилища — потенциально лишнее.
- Есть отдельная вкладка «История состояния». Поле «Предыдущее состояние» лучше вычислять из истории, чтобы не расстраивать согласованность. Либо хранить, но строго описать, когда и кем оно заполняется.
**Решить, как делаем**

### Отсутствует сортировка/пагинация
- Для «Списка оборудования» сортировка «не предусмотрена», хотя это базовый сценарий (по дате, статусу, складу, ID, серийному номеру и т.д.) и пагинация
**Добавить сортировку(определить необходимый набор) и пагинацию**
-----

## Предложения для улучшения

### Идентификация единицы оборудования
- [] Серийный номер / IMEI / ICCID / MAC (в зависимости от типа).
- [] Инвентарный номер (внутренний), номер партии/поставки, комплектность.
- [] Гарантийная информация: срок, дата начала, дата окончания, основание (покупка/акт монтажа).

### Строгая связь с продуктом (SKU).
- [] Поле «Продукт» (МногиеКодному → Продукты)
- [] «Код из 1С» через продукт, чтобы синхронизировать номенклатуру.

### Модель местоположения (Location) вместо «Склад/У заказчика/Под отчёт».
- [] Единая сущность «Местоположение»: Склад, У сотрудника, У клиента (консигнация), На ТС, Утилизация/Списание
> Это снимет двусмысленности и подружит статусы с отчётами по «Продуктам».

### Документооборот перемещений:
- [] Приёмка (покупка, ответхранение, производство).
- [] Перемещение между складами.
- [] Выдача сотруднику / возврат сотрудника.
- [] Консигнация клиенту / возврат клиента.
- [] Монтаж на ТС / демонтаж.
- [] Продажа/отгрузка.
- [] Рекламация/ремонт (вход/выход из ремонта).
- [] Списание/утилизация. \
**Связать каждую операцию с изменением статуса/местоположения и писать в «Историю состояния».**

### Состояния и переходы (state machine).
- [] Определить допустимые переходы (например, На складе → Выдано под отчёт → Установлено и т.д.)
- [] Обязательность заполнения полей при каждом переходе (напр., при Установлено — указать ТС и дату монтажа).

### Добавить валидацию на уровне бизнес правил
- [] Уникальность серийников/IMEI/ICCID.
- [] Обязательность «Склад» при статусах хранения на складе; запрет при «Установлено/Утиль».
- [] Обязательность «Физлицо» при «Выдано под отчёт»; «Юрлицо клиента» при «У заказчика».
- [] «Дата монтажа» не раньше даты поступления и не в будущем (или объяснить допуска).
- [] «СКЗИ дата по = дата с + 3 года» только для соответствующих продуктов.
- [] ...

### Комплектность и связи между единицами оборудования.
**Например: трекер + антенна + SIM — как комплект (parent/child), чтобы не терять состав при перемещениях/монтаже.**

### Права доступа и аудит.
- [] RBAC на операции (кто может перемещать/списывать), полный журнал изменений (кто/когда/что).
**Сейчас есть только «Кто изменил», но нет правил доступа.**

### Инвентаризация и штрих/QR-кодирование.
- [] Печать этикеток, сканирование для быстрых перемещений/проверок.

### Отчётность
- [] Остатки по складам
- [] Движение за период
- [] Установленная база по клиентам/ТС
- [] Гарантийные списки
- [] Рекламации
- [] Скорость оборота
- [] Расхождения

### Статусы и агрегаты
- [] Выстроить единый перечень статусов/категорий, согласованный с «Продуктами» (чтобы корректно считались поля «На складе», «Под отчёт сотруднику/клиенту», «Выполнено/Установлено», «Рекламация», «Утиль», «Продано»)







### Нужны ТЗ:
1. Склад(продукты)
2. ТС(продукты)
3. Накладная отгрузки(продукты)
4. Выдачи под отчет(продукты)
5. Задачи(юр лица)
6. Документы(юр лица)
7. Движение денежных средств(юрлица, что вообще такое???)
8. Платёжные реквизиты(юрлица)
9. Файлы(юрлица)
10. Услуги(юрлица)
11. Комментарий(юрлица)
12. Телефон(физлица)
13. Карта водителя

Справочники с возможными значениями для раздела продукты:
1. Тип продукта
2. Единица измерения
3. Группа продукции
4. Подгруппа продукции
5. Страны

Справочники с возможными значениями для раздела оборудование:
1. Состояние

Справочники с возможными значениями для раздела Юрлицо:
1. Адрес(набор полей - Индекс, Область, район, город/село/деревня, проспект/улица/площадь/проез/и т.д. дом, литера, офис возможные типы указываются в отдельном справочнике)

Справочники с возможными значениями для раздела Физлицо:
1. Должность
2. Статус
3. 

